"use strict";(self.webpackChunkworldify=self.webpackChunkworldify||[]).push([[488],{488:(e,t,r)=>{r.r(t),r.d(t,{render:()=>c});var n=r(18),i=(r(29),r(797)),o=r(401),s=r(338);async function a(e,t,r){const i='[w-el="'+e+'"]',s={container:document.querySelector(i),hidden:r,hideHeaders:!0,hideFooter:!0,opacity:0,height:600,onSubmit:async({formId:e,responseId:t})=>{await async function(e,t){const r=(0,o.getCookie)("wized_token"),n=new FormData;n.append("form_id",e),n.append("response_id",t);try{const e=await fetch("https://xfa3-mghj-yd9n.n7c.xano.io/api:ghdeJJTr/typeform_submissions/health-insurance",{method:"POST",headers:{Authorization:"Bearer "+r},body:n}),t=await e.json();return e.ok?t:(console.error("Retrival of Typform Response failed:",t.message||"Unknown error"),null)}catch(e){return console.error("Error verifying token:",e),!1}}(e,t)}};(0,n.createWidget)(t,s)}function c(){try{const e=document.querySelector('[w-el="slide1_externalData"]'),t=document.querySelector('[w-el="slide2_reviewData"]'),r=document.querySelector('[w-el="typeform_quiz"]');document.querySelector('[w-el="prefill_yes"]').addEventListener("click",(async function(){e.classList.add("hide"),t.classList.remove("hide"),(0,i.vI)();const r=await(0,o.getAccountSettings)((0,o.getCookie)("wized_token"));if(r.success){(0,s.Mk)(r.user,"account_");const e=document.querySelector('[w-el="formWrapper"]');e?e.addEventListener("change",(0,s.Ds)((e=>(0,s.Gt)(e,"https://xfa3-mghj-yd9n.n7c.xano.io/api:ghdeJJTr/account_settings")),500)):logging.warning({message:"render: Form wrapper not found",eventName:"render_no_formWrapper"})}else logging.error({message:"render: Failed to fetch account settings: "+r.message,eventName:"render_fetch_error",extra:{}})})),document.querySelector('[w-el="proceedToQuiz"]').addEventListener("click",(async function(){const e=await(0,o.getAccountSettings)((0,o.getCookie)("wized_token"));t.classList.add("hide"),r.classList.remove("hide");const n={citizenship:e.user.citizenship,citizenship_2:e.user.citizenship_2,residence_country:e.user.residence_country,relocation_date:e.user.relocation_date,birth_date:e.user.birth_date,birth_date_is_before_1969_01_01:e.user.birth_date?new Date(e.user.birth_date)<new Date("1969-01-01"):null};await a("typeform_quiz","siLiU31K",n)})),document.querySelector('[w-el="prefill_no"]').addEventListener("click",(async function(){e.classList.add("hide"),r.classList.remove("hide"),await a("typeform_quiz","siLiU31K",{})}))}catch(e){}}}}]);
//# sourceMappingURL=488.bundle.1.0.13.js.map