{"version":3,"file":"948.bundle.1.0.14.js","mappings":"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","sources":["webpack://worldify/./src/modules/pages/app/dashboard.js"],"sourcesContent":["import { logging } from \"../../utils\";\n\nconst { getCookie } = require(\"../../auth\");\n\n/**\n * Renders the dashboard and sets up event listeners for interactive elements.\n */\nexport async function render() {\n    try {\n\n        //hideLoaders();\n        // Render the dashboard contents\n        await renderDashboard();\n\n        // Setup event listener for module list interactions\n        setupModuleListEventListener();\n    } catch (error) {\n        // Log any errors encountered during the rendering process\n        logging.error({\n            message: \"Error during rendering dashboard: \" + error.message,\n            eventName: \"dashboard_render_error\",\n            extra: {}\n        });\n    }\n}\n\n/**\n * Creates an HTML card for a dashboard module.\n * \n * @param {Object} module - The module data to create a card for.\n * @returns {string} - HTML string representation of the dashboard card.\n */\nfunction createDashboardCard (module) {\n    let pinClass = \"\";\n    let completedClass = \"\";\n    let ctaText = \"Open Task\";\n    let comingSoonClass = \"\";\n    let color;\n    if (module.is_pinned) {    \n        pinClass = \"is-pinned\";\n    } else if (module.is_completed) {\n        completedClass = \"is-completed\";\n        ctaText = \"Completed\";\n        pinClass = 'hide';\n    }\n\n    if (module.status === \"coming soon\"){\n        comingSoonClass = \"is-coming-soon\";\n        ctaText = \"Coming soon\"\n    }\n\n    switch (module.module_category) {\n        case \"Before you move\":\n            color = \"background-color-light-blue\";\n            break;\n        case \"1-3 months in Germany\":\n            color = \"background-color-light-pink\";\n            break;\n        case \"First year in Germany\":\n            color = \"background-color-light-green\";\n            break;\n        case \"Life in Germany\":\n            color = \"background-color-light-orange\";\n            break;\n        default:\n            break;\n    }\n    return `\n    <div w-el=\"module_item\" id=${module.id} class=\"card is-no-margin is-hover\">\n  <div class=\"task-item ${comingSoonClass}\">\n    <div class=\"task_progress-color-wrapper ${comingSoonClass}\">\n      <div class=\"task_progress-color ${color} ${completedClass} ${comingSoonClass}\"></div>\n    </div>\n    <div class=\"task_meta-wrapper\">\n      <div w-el=\"module_pinButton\" class=\"pin-button\">\n        <div class=\"pin-button_icon w-embed ${pinClass}\">\n          <svg\n            width=\"74\"\n            height=\"74\"\n            viewBox=\"0 0 74 74\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M19.6866 53.3504L21.1008 51.9362L19.6866 50.522L6.38494 37.2203C5.57291 36.4083 5.29235 35.6333 5.28076 35.0128C5.2693 34.4017 5.513 33.6921 6.22866 32.9764C10.6477 28.5574 19.2996 27.1345 28.1763 31.2918L29.3518 31.8423L30.3334 30.9928L42.402 20.5469L43.3574 19.72L43.021 18.5021C41.4916 12.9662 40.9287 8.01808 41.2424 5.48661C41.394 4.34834 41.7859 3.66432 42.1421 3.30805C42.5181 2.93204 42.9181 2.8003 43.2936 2.81512C43.6811 2.83041 44.2172 3.01213 44.7901 3.58504L71.0001 29.795C71.5566 30.3516 71.7439 30.8886 71.7609 31.2881C71.7773 31.675 71.6438 32.0759 71.2769 32.4428C70.9434 32.7763 70.2533 33.161 69.0741 33.3181C66.5427 33.6319 61.5944 33.0689 56.0583 31.5394L54.8404 31.203L54.0135 32.1584L43.5676 44.2271L42.7182 45.2087L43.2687 46.3842C47.4259 55.2608 46.003 63.9128 41.584 68.3318C40.8683 69.0475 40.1587 69.2911 39.5476 69.2798C38.9271 69.2681 38.1522 68.9876 37.3402 68.1756L24.0385 54.8739L22.6243 53.4597L21.2101 54.8739L9.75649 66.3275C8.0822 68.0017 6.19501 69.1886 4.67968 69.8839C5.37073 68.3679 6.55726 66.4798 8.23303 64.804L19.6866 53.3504Z\"\n              fill=\"currentColor\"\n              stroke=\"black\"\n              stroke-width=\"4\"\n            ></path>\n          </svg>\n        </div>\n      </div>\n      <a w-el=\"module_link\" href=\"${module.module_link}\" class=\"open-task-button w-inline-block ${comingSoonClass}\"\n        ><div class=\"task_open-text\">${ctaText}</div>\n        <div class=\"icon-embed-xsmall w-embed\">\n          <svg\n            width=\"15\"\n            height=\"15\"\n            viewBox=\"0 0 15 15\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M14.5931 0.983396C14.5753 0.4314 14.1133 -0.00160407 13.5613 0.0162529L4.56602 0.307258C4.01402 0.325115 3.58102 0.787073 3.59887 1.33907C3.61673 1.89106 4.07869 2.32407 4.63068 2.30621L12.6265 2.04754L12.8852 10.0434C12.903 10.5954 13.365 11.0284 13.917 11.0105C14.469 10.9926 14.902 10.5307 14.8841 9.97869L14.5931 0.983396ZM2.16725 14.6684L14.3232 1.6996L12.864 0.331856L0.708052 13.3007L2.16725 14.6684Z\"\n              fill=\"currentColor\"\n            ></path>\n          </svg></div\n      ></a>\n    </div>\n    <a\n      w-el=\"module_link\"\n      href=\"${module.module_link}\"\n      class=\"task_header-wrapper w-inline-block\"\n      ><h3 w-el=\"module_title\" class=\"heading-style-h6\">${module.module_title}</h3>\n      <div class=\"spacer-small\"></div>\n    </a>\n  </div>\n</div>\n`;\n};\n\n/**\n * Fetches module data from the server.\n * Uses the 'wized_token' from cookies for authorization.\n * \n * @returns {Promise<Object|null>} The module data if successful, or null if an error occurs.\n */\nasync function getModules() {\n    const token = `Bearer ${getCookie(\"wized_token\")}`;\n\n    try {\n        // Send a GET request to the server to fetch modules\n        const response = await fetch(`${BASE_URL}/modules`, {\n            method: 'GET',\n            headers: { Authorization: token }\n        });\n\n        // Parse the response to JSON\n        const data = await response.json();\n\n        if (response.ok) {\n            return data;\n        } else {\n            // Log non-successful responses using the custom logging framework\n            logging.error({\n                message: `Failed to fetch modules: ${response.status} - ${response.statusText}`,\n                eventName: \"getModules_failure\",\n                extra: {}\n            });\n            return null;\n        }\n    } catch (error) {\n        // Log any errors during the fetch process using the custom logging framework\n        logging.error({\n            message: \"Error during getModules: \" + error.message,\n            eventName: \"getModules_error\",\n            extra: {}\n        });\n        return null;\n    }\n}\n\n\n/**\n * Pins a module by sending a POST request with the module's ID.\n * \n * @param {string} module_id - The ID of the module to be pinned.\n * @returns {Promise<Object|null>} The response data if successful, or null if an error occurs.\n */\nasync function pinModule(module_id) {\n\n    const token = `Bearer ${getCookie(\"wized_token\")}`;\n\n    const formData = new FormData();\n    formData.append('module_id', module_id);\n\n    try {\n        const response = await fetch(`${BASE_URL}/modules/utils/pin_module`, {\n            method: 'POST',\n            headers: { Authorization: token },\n            body: formData\n        });\n\n        const data = await response.json();\n\n        if (response.ok) {\n            logging.info({\n                message: \"Module pinned successfully. Module_id: \"+ module_id,\n                eventName: \"pinModule_success\",\n                extra: {}\n            });\n            return data;\n        } else {\n            logging.error({\n                message: `Failed to pin module (${module_id}): ${response.status} - ${response.statusText}`,\n                eventName: \"pinModule_failure\",\n                extra: {}\n            });\n            return null;\n        }\n    } catch (error) {\n        logging.error({\n            message: \"Error during pinModule. Module_id: \" + module_id,\n            eventName: \"pinModule_error\",\n            extra: {}\n        });\n        return null;\n    }\n}\n\n\n/**\n * Renders the dashboard by fetching and displaying modules in their respective categories.\n */\nasync function renderDashboard() {\n    try {\n        // Define the category lists\n        const categoryLists = {\n            'Before you move': document.querySelector('[w-el=\"before_you_move_list\"]'),\n            '1-3 months in Germany': document.querySelector('[w-el=\"1_3_months_list\"]')\n        };\n\n        // Fetch module data\n        const data = await getModules();\n        if (!data) {\n            logging.error({\n                message: \"No data returned from getModules\",\n                eventName: \"renderDashboard_getModules_no_data\"\n            });\n            return;\n        }\n\n        // Clear all lists before fetching new module data\n        Object.keys(categoryLists).forEach(category => {\n            clearList(categoryLists[category]);\n        });\n\n        // Populate each list with filtered and sorted module data\n        Object.keys(categoryLists).forEach(category => {\n            const filteredModules = filterAndSortModules(data, category);\n            populateList(categoryLists[category], filteredModules);\n        });\n    } catch (error) {\n        logging.error({\n            message: \"Error during renderDashboard: \" + error.message,\n            eventName: \"renderDashboard_error\",\n            extra: {}\n        });\n    }\n}\n\nfunction filterAndSortModules(data, category) {\n    return data\n        .filter(item => item.module_category === category)\n        .sort((a, b) => a.order - b.order);\n}\n\nfunction populateList(listElement, modules) {\n    const moduleElements = { pinned: [], normal: [], completed: [] };\n\n    modules.forEach(module => {\n        const htmlObject = createDashboardCard(module);\n        const listType = module.is_completed ? 'completed' : module.is_pinned ? 'pinned' : 'normal';\n        moduleElements[listType].push(htmlObject);\n    });\n\n    ['pinned', 'normal', 'completed'].forEach(listType => {\n        moduleElements[listType].forEach(element => {\n            listElement.innerHTML += element;\n        });\n    });\n}\n\nfunction clearList(listElement) {\n    while (listElement.firstChild) {\n        listElement.removeChild(listElement.firstChild);\n    }\n}\n\n/**\n * Sets up an event listener for the module list.\n * Listens for click events to pin modules.\n */\nfunction setupModuleListEventListener() {\n    const module_list = document.querySelector('[w-el=\"before_you_move_list\"]');\n\n    module_list.addEventListener('click', async function(event) {\n        const target = event.target.closest('[w-el=\"module_pinButton\"]');\n        if (target) {\n            const module_item = target.closest('[w-el=\"module_item\"]');\n            if (module_item && module_item.id) {\n                try {\n                    await pinModule(module_item.id);\n                    await renderDashboard();\n                } catch (error) {\n                    logging.error({\n                        message: \"Error during module pinning: \" + m+ error.message,\n                        eventName: \"module_pinning_error\",\n                        extra: {}\n                    });\n                }\n            }\n        }\n    });\n}\n\nfunction hideLoaders() {\n    \n    const skeletonElements = document.querySelectorAll('[loader-skeleton]');\n\n    console.log(skeletonElements);\n        \n    skeletonElements.forEach(element => {\n        // Create a skeleton div\n        const skeletonDiv = document.createElement('div');\n        skeletonDiv.classList.add('skeleton-loader');\n    \n        // Add the skeleton div to the current element\n        element.style.position = 'relative';\n        element.appendChild(skeletonDiv);\n    \n        // Get delay from the attribute\n        let delay = element.getAttribute('loader-skeleton');\n    \n        // If attribute value is not a number, set default delay as 2000ms\n        if (isNaN(delay)) {\n        delay = 2000;\n        }\n    \n        setTimeout(() => {\n        // Remove the skeleton loader div after delay\n        const skeletonDiv = element.querySelector('.skeleton-loader');\n        element.removeChild(skeletonDiv);\n        }, delay);\n    });\n}\n"],"names":["getCookie","async","render","renderDashboard","document","querySelector","addEventListener","event","target","closest","module_item","id","module_id","token","formData","FormData","append","response","fetch","method","headers","Authorization","body","data","json","ok","info","message","eventName","extra","error","status","statusText","pinModule","m","categoryLists","getModules","Object","keys","forEach","category","listElement","firstChild","removeChild","clearList","filteredModules","filter","item","module_category","sort","a","b","order","filterAndSortModules","modules","moduleElements","pinned","normal","completed","module","htmlObject","color","pinClass","completedClass","ctaText","comingSoonClass","is_pinned","is_completed","module_link","module_title","createDashboardCard","listType","push","element","innerHTML","populateList"],"sourceRoot":""}