"use strict";(self.webpackChunkworldify=self.webpackChunkworldify||[]).push([[818],{818:(e,i,n)=>{n.r(i),n.d(i,{render:()=>a});var s=n(401),o=n(338),t=n(797);async function a(){const e=document.querySelector('[w-el="verification_success"]'),i=document.querySelector('[w-el="verification_failed"]'),n=i.querySelector('[w-el="verificationFailed_text"]');(0,t.vI)();try{const o=await(0,s.checkAuthentication)();if(o.success&&!o.user.is_verified){const o=(0,s.getQueryParam)("token"),a=new FormData;a.append("magic_token",o);try{const o=await fetch("https://xfa3-mghj-yd9n.n7c.xano.io/api:xhKh0vlR/auth/magic-login",{method:"POST",body:a}),r=await o.json();o.ok&&(await(0,s.checkAuthentication)()).user.is_verified?(e.classList.remove("hide"),setTimeout((()=>e.classList.add("hide")),1e4)):(n.textContent="Email Verification failed. "+r.message+". You will be redirected to the Resend Email Verification Link page shortly to try again.",i.classList.remove("hide"),t.PW.warning({message:`Email verification failed (${user.email}): ${r.message}. Redirecting to Resend Email Verification Link page.`,eventName:"email_verification_failed"}),setTimeout((()=>{(0,s.redirectResendEmailVerification)(),i.classList.add("hide")}),1e4))}catch(e){t.PW.error({message:`Error with magic login: ${e.message}`,eventName:"magic_login_error",extra:{}})}}}catch(e){t.PW.error({message:`Authentication check failed: ${e.message}`,eventName:"auth_check_failure",extra:{}})}(0,o.EV)("onboarding_form_1",r,c,d,!1),(0,o.EV)("onboarding_form_2",r,c,m,!1)}function r(e){const i=new FormData;for(const[n,s]of e.entries()){const e=n.split("_").slice(1).join("_"),o=e.split("__");if(2===o.length){const[e,n]=o;i.append(`${e}[${n}]`,s)}else i.append(e,s)}return i}async function c(e){const i=(0,s.getCookie)("wized_token");try{const n=await fetch("https://xfa3-mghj-yd9n.n7c.xano.io/api:ghdeJJTr/onboarding",{method:"POST",headers:{Authorization:`Bearer ${i}`},body:e}),s=await n.json();if(n.ok)return t.PW.info({message:"Onboarding form submission successful",eventName:"onboarding_submission_success",extra:{}}),{success:!0,message:"Submitting onboarding information was successful."};{const e=s.message||"Onboarding submission failed due to an unknown error";return t.PW.error({message:`Onboarding form submission failed: ${e}`,eventName:"onboarding_submission_failed",extra:{}}),{success:!1,message:e}}}catch(e){return t.PW.error({message:`Error during onboarding form submission process: ${e.message}`,eventName:"onboarding_submission_process_error",extra:{}}),{success:!1,message:e.message||"Error occurred during the onboarding submission process"}}}async function d(e){const i=document.getElementById("onboarding_form_1").parentElement,n=document.getElementById("onboarding_form_2").parentElement;i&&n&&(i.classList.add("hide"),n.classList.remove("hide"))}async function m(e){const i=document.getElementById("onboarding_form_2").parentElement,n=document.getElementById("onboarding_pricing");i&&n&&(i.classList.add("hide"),n.classList.remove("hide"))}}}]);
//# sourceMappingURL=818.bundle.1.0.10.js.map